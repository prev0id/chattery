syntax = "proto3";

package chat_service;

option go_package = "chattery/user_service/api;user_servicepb";

import "google/api/annotations.proto";

service UserService {
  rpc SignUpV1(SignUpV1Request) returns (SignUpV1Response) {
    option (google.api.http) = {
      post: "/v1/signup"
      body: "*"
    };
  }
  rpc LogInV1(LogInV1Request) returns (LogInV1Response) {
    option (google.api.http) = {
      post: "/v1/login"
      body: "*"
    };
  }
  rpc LogOutV1(LogOutV1Request) returns (LogOutV1Response) {
    option (google.api.http) = {
      post: "/v1/logout"
      body: "*"
    };
  }
  rpc UpdateV1(UpdateV1Request) returns (UpdateV1Response) {
    option (google.api.http) = {
      put: "/v1/update"
      body: "*"
    };
  }
  rpc ValidateV1(ValidateV1Request) returns (ValidateV1Response) {
    option (google.api.http) = {
      post: "/v1/validate"
      body: "*"
    };
  }
  rpc UploadProfileImageV1(UploadProfileImageV1Request) returns (UploadProfileImageV1Response) {
    option (google.api.http) = {
      post: "/v1/upload_profile_image"
      body: "*"
    };
  }
  rpc GetUsersInfoV1(GetUsersInfoV1Request) returns (GetUsersInfoV1Response) {
    option (google.api.http) = {
      get: "/v1/get_users_info"
    };
  }
}

message SignUpV1Request {
  string username = 1;
  string login = 2;
  string password = 3;
}

message SignUpV1Response {
  Session session = 1;
}

message LogInV1Request {
  string login = 1;
  string password = 2;
}

message LogInV1Response {
  Session session = 1;
}

message LogOutV1Request {
}

message LogOutV1Response {
  Session session = 1;
}

message UpdateV1Request {
  Session session = 1;
  string username = 2;
  string login = 3;
  string password = 4;
}

message UpdateV1Response {
}

message ValidateV1Request {
  Session session = 1;
}

message ValidateV1Response {
  UserInfo info = 1;
}

message UploadProfileImageV1Request {
  Session session = 1;
  string type = 2;
  bytes content = 3;
}

message UploadProfileImageV1Response {
  string image_id = 1;
}

message GetUsersInfoV1Request {
  repeated int64 ids = 1;
}

message GetUsersInfoV1Response {
 repeated UserInfo info = 1;
}

message UserInfo {
  int64 user_id = 1;
  string username = 2;
  string image_id = 3;
}

message Session {
    string name = 1;
		string value = 2;
		string path = 3;
		int64 max_age = 4;
		bool secure = 5;
		bool http_only = 6;
		int64 same_site = 7;
}
